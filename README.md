# Predictive Restaurant Recommender

This repository contains the solution for the Data Scientist Intern assignment from Soulpage IT Solutions. The project aims to build a machine learning model that predicts which restaurants a customer is most likely to order from.

---

## Evaluation Criteria

This project is structured to address the specified evaluation criteria:

### 1. Data Pre-processing and Analysis

* **Data Loading & Integration:** The initial step involved loading and integrating six distinct CSV files: `orders`, `vendors`, `train_customers`, `train_locations`, `test_customers`, and `test_locations`.
* **Data Cleaning:** A thorough cleaning process was performed:
    * **Dropped Irrelevant Columns:** Columns that would not be available at the time of prediction (e.g., `driver_rating`, `delivery_time`) or had excessive missing values were removed to prevent data leakage and reduce noise.
    * **Handled Missing Values:** Missing data in critical columns like `commission` were filled using the median, while categorical columns like `vendor_tag` were filled with the most frequent value (mode).
    * **Type Conversion:** Columns were converted to their appropriate data types, such as `created_at` to datetime objects and `is_favorite` from 'Yes'/'No' to binary (1/0) for modeling.

### 2. Data Exploration & Feature Engineering

The core of the predictive power comes from carefully engineered features that describe the historical relationships between customers and vendors.

* **Vendor-Level Features:** To capture the popularity and scale of each restaurant.
    * `vendor_total_orders`: Total number of orders received by a vendor.
    * `vendor_avg_grand_total`: The average order value for a vendor.
    * `vendor_unique_customers`: Number of unique customers who have ordered from a vendor.

* **Customer-Level Features:** To model the behavior and loyalty of each customer.
    * `customer_total_orders`: Total number of orders placed by a customer.
    * `customer_avg_grand_total`: The average amount a customer spends per order.
    * `customer_unique_vendors`: The variety of restaurants a customer has ordered from.

* **Customer-Vendor Interaction Features:** To capture the specific relationship between a customer and a restaurant.
    * `customer_vendor_order_count`: How many times a specific customer has ordered from a specific vendor. This is a strong indicator of preference.

### 3. Model Building

* **Problem Framing:** The recommendation task was framed as a **binary classification problem**. The goal is to predict a `target` of 1 (will order) or 0 (will not order) for each customer-vendor pair.
* **Negative Sampling:** The provided `orders.csv` only contains positive examples (orders that happened). To train a robust classifier, negative samples were generated by creating all possible customer-vendor pairs and excluding the pairs that actually occurred in the order history.
* **Model Selection:** A **LightGBM Classifier** (`lgb.LGBMClassifier`) was chosen for this task. LightGBM is a high-performance gradient boosting framework known for its speed and accuracy, making it well-suited for this type of tabular dataset.
* **Prediction:** The trained model was used to predict the probability of an order for every customer-location-vendor combination in the test set. A threshold of 0.5 was used to convert these probabilities into the final binary `target`.

---

## Final Output

The final predictions are saved in **`submission.csv`**, formatted exactly as requested in the problem statement:
`CID X LOC_NUM X VENDOR target`

---

## How to Run

1.  Clone the repository:
    ```bash
    git clone [https://github.com/Anishnemali/Predictive-Restaurant-Recommender.git](https://github.com/Anishnemali/Predictive-Restaurant-Recommender.git)
    ```
2.  Install the required libraries:
    ```bash
    pip install pandas numpy lightgbm
    ```
3.  Place the original data CSV files into a `/data` subfolder within the project directory.
4.  Run the `restaurant_recommender.ipynb` notebook. The `submission.csv` file will be generated in the root directory.
